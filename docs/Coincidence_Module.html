

<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
      
    Coincidence module - CUORE_CUPID
    
    </title>
    
    
    
    <link href="atom.xml" rel="alternate" title="CUORE_CUPID" type="application/atom+xml">
    <link rel="stylesheet" href="asset/style.css">
    
</head>
  <body>




        <div id="wrapper">
            <header class="site-header">
                <div class="container">
                    <div class="site-title-wrapper">
                          <a class="button-square" href="index.html">
<svg class="svg-inline--fa fa-home fa-w-18" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="home" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" data-fa-i2svg=""><path fill="currentColor" d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"></path></svg>
                            </a>
                        
                         
                        
                        
                        
                        <a class="button-square" href="https://github.com/Destiny712" target="_blank" title="github">
                               <svg class="svg-inline--fa fa-github fa-w-16" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" data-fa-i2svg=""><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><!-- <i class="fab fa-github fa-lg"></i> -->
                          </a>
                        
                        
                      
                      <a class="button-square" href="atom.xml" target="_blank" title="RSS">
                              <svg class="svg-inline--fa fa-rss fa-w-14" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rss" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"></path></svg><!-- <i class="fas fa-rss fa-lg"></i> -->
                      </a>

              
                       
                         
                        
                    </div>

                    <ul class="site-nav">
                        
                    </ul>
                </div>
            </header>

            <div id="container">

 
<div class="container">
  <article class="post-container">
    <header class="post-header">
        <h1 class="post-title">Coincidence module</h1>
        <p class="post-date">
                <span>Posted <time datetime="2022/04/28" itemprop="datePublished">2022/04/28</time></span>
            </p>
    </header>

    <div class="post-content clearfix">
<ul>
<li><a href="#coincidence-module">Coincidence module</a>
<ul>
<li><a href="#coincidences">Coincidences</a></li>
<li><a href="#the-calculation-of-coincidences">The calculation of coincidences</a></li>
<li><a href="#jitter">Jitter</a></li>
<li><a href="#response-synchronisation-and-coincidence-calculation">Response synchronisation and coincidence calculation</a></li>
</ul>
</li>
</ul>
<h2><a id="coincidences" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Coincidences</h2>
<p>Coincidences with <strong>response synchronisation</strong> were implemented as the standard method of calculating coincidences for the final CUORE-0 analysis. The performance of this method on the <strong>anti-coincidence</strong> and coincidence <strong>efficiency</strong> is similar or better compared to the previous adopted coincidence analysis, with significant reduction of the rate of random coincidences, by using a <strong>shorter</strong> coincidence window. The analysis is documented in CUORE-0 Internal Note 104D<sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup>.</p>
<h2><a id="the-calculation-of-coincidences" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>The calculation of coincidences</h2>
<p>The calculation of coincidences in <em><strong>Diana</strong></em> is performed by the module <strong>MCoincidence</strong><sup class="footnote-ref"><a href="#fn2" id="fnref2">2</a></sup>. The calculation of coincidences relies on the definition of a coincidence window \(\Delta t\). If the time difference between two or more events is within \(\Delta t\), the <strong>multiplicity</strong> of the event is increased accordingly. In CUORE analysis we also use the so called <em>running window</em>. Given a value \(t\) for the coincidence window, a running window will open at first event and will close when there are no more events <strong>within</strong> time \(t\) of the last event.<br />
The module MCoincidence is executed on events that have already gone through several steps of the analysis chain (<em>amplitude</em>, <em>stabilisation</em>, <em>energy calibration</em>). The module MCoincidence allows the analyst to choose the time of the event to be used to calculate \(\Delta t\). Possible choices are:</p>
<ul>
<li>the <strong>raw</strong> time of the event;</li>
<li>the <strong>OF</strong> time, that is: (raw time + \(\rm{OF_{Delay}}\)/1000 - sample index/sampling frequency);</li>
<li>the <strong>synchronised</strong> time, calculated with the method described <a href="#response-synchronisation-and-coincidence-calculation">below</a>.</li>
</ul>
<p>The variable \(\rm{OF_{Delay}}\) above is calculated by the <strong>OptimumFilter</strong> and it’s defined as the distance in ms between the <strong>trigger</strong> position and the maximum of the <strong>filtered</strong> waveform.<br />
The response synchronisation is a method to <strong>compensate</strong> for the existence of a channel to channel <strong>variance</strong> in detector time response.</p>
<ul>
<li>A true (physical) <strong>coincidence</strong> among different bolometers is originated from a particle passing through <strong>more than one crystal</strong> and releasing energy above <strong>threshold</strong> in all of them;</li>
<li>Or from <strong>more than one particle</strong> emitted <strong>simultaneously</strong> from the same radioactive decay and crossing different bolometers at the same time.</li>
</ul>
<p>In both cases, the time difference among the various energy <strong>releases</strong> is negligible with respect to the <strong>intrinsic</strong> rise time of the bolometric signal.<br />
When looking at the distribution of \(\Delta t\) for multiplicity-two events with total energy around 2615 keV, we can see that, instead of being peaked around zero over a flat background of random coincidences, \(\Delta t\) has a <strong>broader</strong> distribution compared to out <em>timing reconstruction precision</em>. Moreover, there are <strong>fine</strong> structures, which represent <strong>characteristic</strong> values of \(\Delta t\) for different couples of channels.</p>
<h2><a id="jitter" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Jitter</h2>
<p>This behaviour can be explained considering that each bolometer has its <strong>own</strong> rise time. A <strong>simultaneous</strong> energy deposition in two bolometers gives rise to events that have a characteristic time <strong>difference</strong>, reflecting the difference in rise time. We call this characteristic time difference the <em><strong>jitter</strong></em> between the two channels. By correcting for it, we can obtain a more <strong>resolved</strong> DeltaT among coincident events and use a much <strong>shorter</strong> coincidence window, thus <strong>reducing</strong> the number of accidental coincidences, that are removed from the analysis, and improving the signal <strong>efficiency</strong>.<br />
From the comparison of the distribution of \(\Delta t\) with a similar plot in Internal Note 104D<sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup>, we can see that the number of multiplicity-two <strong>events</strong> with total energy around 2615 keV for the entire (initial) calibration of ds3021 is below 3000. Considering that CUORE channels are 988, it is clear that the calculation of the <em><strong>jitter</strong></em>s from M2 coincidences calculated over the full CUORE <strong>array</strong> and with a coincidence window of \(100 \ ms\) (<strong>standard</strong> choice without synchronisation) is a <strong>difficult</strong> <del>if not impossible</del> task, because of the <strong>low</strong> statistics. The solution we devised was to use coincidences calculated on a <strong>tower</strong> basis for the jitter calculation. Reducing the number of channels from 988 to 52 means decreasing the rate of accidental coincidences and increasing the M2 statistics. Since the start of the CUORE data taking, we implemented in <em><strong>Diana</strong></em> <strong>two ways</strong> of calculating the jitter: they are described below.</p>
<ul>
<li>Jitter by coincidence</li>
<li>Jitter by delay</li>
</ul>
<h2><a id="response-synchronisation-and-coincidence-calculation" class="anchor" aria-hidden="true"><span class="octicon octicon-link"></span></a>Response synchronisation and coincidence calculation</h2>
<p>The aim of the <strong>CoincidenceSync</strong> method is to correct the \(\Delta t\) among coincident events, synchronising the response of couples of coincident bolometers that suffer from an intrinsic time jitter. In the previous sections we have discussed the calculation of the jitters. In this chapter we describe the <strong>response synchronisation</strong> in coincident events.<br />
Below is how the coincidence module is implemented into the cfg that is used to calculate the coincidences for the full CUORE: <em>coincidence CUORE.cfg</em>. The cfg uses the <strong>ParaRootFileReader</strong>. The standard RootFileReader reads events in the order that they are inputted in the input <strong>root</strong> file or input <strong>list</strong> file. Since the data are stored by tower, an input list that contained all the tower files would necessarily not be time ordered, but rather sorted by <strong>tower</strong> and then by time. This would create problems for coincidence across tower. The ParaRootFileReader takes a list of input files, time sorts it, and reads events sorted by time across the files in <strong>parallel</strong>.</p>
<pre class="line-numbers"><code class="language-plain_text">module Coincidence
enable = true
verbosity = info
CoincidenceWindow = 0.01
# FIXME: put here the correct label for the Energy variable
EnergyLabel = EnergySelector_QNDBD@Energy
TimeVariable = OF
UseRunningWindow = true
ExtraLabel = OFTime_Sync_20ms
SyncTime = true
SyncSource = ${SHARED_SCRATCH}/cuts/ds${DATASET}/jitter_ds${DATASET}.txt
SyncTowerSource = ${SHARED_SCRATCH}/cuts/ds${DATASET}/jitter_tower_ds${DATASET}.txt
TimeProfilingOn = true
OFLabel = FilteredPulseAmplitude_OF
endmod
</code></pre>
<p>If the cfg option <strong>SyncTime</strong> (\(T \eqref{eq: SyncTimeDef}\)) is set to true, two input sources for the jitters must be provided (<strong>SyncSource</strong> and <strong>SyncTowerSource</strong>), the first one being the file that contains the jitters by <strong>coincidence</strong> and the second one the file containing the jitters by <strong>delay</strong>. The module calculates a corrected time of each events in the following way:</p>
\[\begin{equation} 
	T = T + jitter\_by\_coincidence_{channel, ref} + jitter\_by\_delay_{ref} 
\label{eq: SyncTimeDef} 
\end{equation} 
\]
<p>where \(jitter\_by\_coincidence_{channel, ref}\) is the jitter by coincidence of the channel wrt the reference channel of the corresponding tower and \(jitter\_by\_delay_{ref}\) is the mean value of \(\rm{OF_{Delay}}\) for the reference channel. Although named jitter by delay, this quantity is not exactly a jitter (so a time difference) but a characteristic value of \(\rm{OF_{Delay}}\). The \(\Delta t\) calculated from the difference of the times corrected as described above will be not affected by any characteristic jitter. The module uses it to calculate the <strong>multiplicity</strong> of the event.</p>
<p>After the synchronisation, a much <strong>shorter</strong> coincidence window can be applied. The result of the synchronisation is shown, where on the distribution of the \(\Delta t\) already shown, we have superimposed the same distribution after correcting for the jitter. This extends from -10 ms to 10 ms because of the shorter coincidence window applied.</p>
<p>In the PRL data processing we have 4 different calculated coincidences:</p>
<ul>
<li>Coincidence_OFTime: Threshold 30 keV - Coincidence window 100 ms - No Sync</li>
<li>Coincidence_OFTime_Sync_20ms: Threshold 30 keV - Coincidence window 20 ms - Sync</li>
<li>Coincidence_OFTime_Sync_10ms: Threshold 30 keV - Coincidence window 10 ms - Sync</li>
<li>Coincidence_OFTime_Sync_10ms_150keV: Threshold 150 keV - Coincidence window 10 ms - Sync</li>
</ul>
<p>The final choice was to use the Coincidence_OFTime_Sync_10ms_150keV as standard coincidence calculation.</p>
<section class="footnotes">
<ol>
<li id="fn1">
<p>CUORE-0 Internal Note 104D <a href="http://docdb.wlab.yale.edu:8080/cuore/ShowDocument?docid=9">http://docdb.wlab.yale.edu:8080/cuore/ShowDocument?docid=9</a>. <a href="#fnref1" class="footnote-backref">↩</a></p>
</li>
<li id="fn2">
<p>The module MCoincidence <a href="https://cuore-collab.lngs.infn.it/swdoc/master/classMCoincidence.html">https://cuore-collab.lngs.infn.it/swdoc/master/classMCoincidence.html</a>. <a href="#fnref2" class="footnote-backref">↩</a></p>
</li>
</ol>
</section>

    </div>
    <footer class="post-footer clearfix">
      
           
      
        
    </footer>
     <div class="comments-wrap">
        <div class="share-comments">
          

          

          
        </div>
      </div><!-- end comments wrap -->
  </article>
 </div><!-- end-->



    <footer class="footer">
            <div class="container">
                <div class="site-footer-wrapper">
                        <a class="button-square" href="index.html">
<svg class="svg-inline--fa fa-home fa-w-18" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="home" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" data-fa-i2svg=""><path fill="currentColor" d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"></path></svg>
                            </a>
                        
                         
                        
                        
                        
                        <a class="button-square" href="https://github.com/Destiny712" target="_blank" title="github">
                               <svg class="svg-inline--fa fa-github fa-w-16" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" data-fa-i2svg=""><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg><!-- <i class="fab fa-github fa-lg"></i> -->
                          </a>
                        
                        
                      
                      <a class="button-square" href="atom.xml" target="_blank" title="RSS">
                              <svg class="svg-inline--fa fa-rss fa-w-14" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="rss" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"></path></svg><!-- <i class="fas fa-rss fa-lg"></i> -->
                      </a>

              
                       
                                                
                </div>
                <div class="site-menu-wrapper">
                  &nbsp;<span>|</span>&nbsp;
                  
                    <a target="self" class="" href="index.html">Home</a>
                    &nbsp;<span>|</span>&nbsp;
                  
                    <a target="_self" class="" href="archives.html">Archives</a>
                    &nbsp;<span>|</span>&nbsp;
                                             
                </div>

                <p class="footer-copyright">
                        Copyright &copy; 2019
                        Powered by <a target="_blank" href="http://www.mweb.im">MWeb</a>,&nbsp; 
                        Theme used <a target="_blank" href="https://blog.timac.org">Timac</a>.
                </p>
            </div>
        </footer>



<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>

  













<script src="asset/prism.js"></script>

        
      
  
    


    </body>
</html>
